# Session Note: 2026-02-11 Late Night

# 软件工程经验笔记 (续)

> 本笔记从 role-SECA 重构和文件组织工作中提炼规则。
> 原则定义见 [INDEX.md](./INDEX.md)，此处仅引用编号。

---

## 规则 6：系统不该自相矛盾

**工程概念**: Internal Consistency (内部一致性)

**通俗解释**:
你写了一条规则说"禁止在周末加班"，又写了另一条说"每周六必须开会"。
这两条规则自相矛盾 -- 遵守一条就违反另一条。系统越大，这种矛盾越容易藏得深。

**在本项目中**:
`role-SECA.md` 第 10 行写着"严禁创建 `.` 开头的文件夹"，但分步执行协议恰恰需要 `.agent/workflows/`。
AI 遵守了后者，就违反了前者 -- 规则自相矛盾了。

**工程规则**:
- 每条新规则写入前，**检查是否与已有规则冲突**
- 规则库越大越需要定期审计一致性
- 如果发现矛盾，修改**更旧的那条** (通常是旧规则没考虑到新场景)

**关联原则**: `ARCH-02` (Single Source of Truth) -- 规则也应有单一权威版本

---

## 规则 7：你的东西必须能跟着你走

**工程概念**: Portability (可移植性)

**通俗解释**:
你在公司电脑上存了所有工作文件，但笔记本放在了同事的文件夹里，配置文件放在了公共盘上。
有一天你换了工位，你的文件都在，但笔记和配置找不到了。

**工程规则**:
设计任何"个人工作空间"时，用一个简单测试：

> "如果只复制这一个文件夹到新环境，所有功能能正常工作吗？"
>
> 如果答案是"不能，因为有些文件在外面" --> 你有可移植性问题。

**在本项目中**:
`role-SECA.md` 和 `.agent/workflows/` 都在 `_ai_evolution/` 外面。
如果 `_ai_evolution/` 被移走，AI 丢失了自己的规则和协议。

**解决**: 正本放 `_ai_evolution/` 内，外面只放系统需要的精简副本。

**关联原则**: `ARCH-01` (Separation of Concerns) -- 谁的东西归谁管

---

## 规则 8：重型依赖是隐形的资源炸弹

**工程概念**: Dependency Weight Awareness (依赖重量意识)

**通俗解释**:
你只想要一个"切菜"功能，结果安装了一整套厨房管理系统（含冰箱监控、库存管理、外卖对接）。
切菜功能确实有了，但你的手机存储满了。

**工程规则**:
安装任何依赖前，检查 3 件事：

1. **兼容性**: 当前环境能跑吗？(Python 版本、OS、CPU 架构)
2. **体积**: 它会拉多少子依赖？占多少内存？
3. **替代方案**: 有没有更轻的库或者内置方案？

```
chromadb (向量数据库):
  兼容性: Python 3.14 ❌ (pydantic v1 不支持)
  体积: ~500MB (含 tokenizers, torch 依赖)
  替代: JSON 文件 + 关键词搜索 ✅ (足够当前需求)
```

**关联原则**: `PRACTICE-01` (Technical Debt Prioritization) -- 装错一个库的代价可能比它节省的时间大得多

---

## 本次修改清单

| 文件 | 改动 |
|------|------|
| `role-SECA.md` | 重写: 新增 Section 6 资源管理, 修复 .agent 矛盾, 去除 emoji, 统一列表格式 |
| `_ai_evolution/workflows/` | 新建, 放分步协议正本 |
| `.agent/workflows/` | 保留精简副本 (系统约定) |
| `STRUCTURE.md` | 更新 _ai_evolution 详细结构 |
